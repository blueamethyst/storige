# PDF 검증 기능 요약

> 작성일: 2025-12-28
> 버전: 1.0

---

## 1. 파일 기본 검증

| 항목 | 설명 | 처리 |
|------|------|------|
| 파일 용량 | 최대 100MB | ❌ 초과 시 오류 |
| 파일 형식 | PDF 전용 | ❌ 미지원 형식 오류 |
| 손상 여부 | PDF 구조 검사 | ❌ 손상 시 오류 |

---

## 2. 페이지 규격 검증

| 항목 | 설명 | 처리 |
|------|------|------|
| 페이지 크기 | 주문 규격과 비교 | ❌ 불일치 시 오류 |
| 페이지 수 | 주문 페이지 수와 비교 | ⚠️ 불일치 시 경고 |
| 가로형 페이지 | 가로/세로 방향 감지 | ⚠️ 가로형 감지 시 경고 |
| 재단 여백(도련) | 3mm 재단선 포함 여부 | ⚠️ 미포함 시 경고 |

---

## 3. 스프레드(펼침면) 형식 지원

| 입력 형식 | 예시 | 자동 감지 |
|-----------|------|-----------|
| 단면 형식 | 210×297mm 40페이지 | ✅ 감지 |
| 펼침면 형식 | 420×297mm 20페이지 | ✅ 감지 |
| 혼합 형식 | 표지(펼침) + 내지(단면) | ⚠️ 경고 후 확인 요청 |

> **예시**: 216×303mm 40페이지로 주문 시 → 432×303mm 20페이지 PDF도 정상 접수

---

## 4. 제본 규격 검증

| 제본 방식 | 검증 항목 | 처리 |
|-----------|-----------|------|
| 사철 제본 | 4의 배수 페이지 필수 | ❌ 위반 시 오류 |
| 사철 제본 | 최대 64페이지 | ❌ 초과 시 오류 |
| 사철 제본 | 중앙부 객체 배치 | ⚠️ 확인 요청 경고 |
| 무선/양장 | 책등 크기 계산 | 자동 계산 |

---

## 5. 색상 모드 검증

| 항목 | 감지 방식 | 처리 |
|------|-----------|------|
| RGB | 구조 분석 | ✅ 정상 (기본) |
| CMYK | 1차: 구조 분석 → 2차: GS inkcov | ⚠️ 경고 (인쇄 품질 확인) |
| 그레이스케일 | K값만 사용 감지 | ✅ 정상 |

---

## 6. 별색(Spot Color) 감지

| 유형 | 예시 | 감지 |
|------|------|------|
| Separation | PANTONE 485 C | ✅ 감지 |
| DeviceN | CutContour, Crease | ✅ 감지 |
| 혼합 | PANTONE + CMYK | ⚠️ 경고 |

**감지되는 별색 예시**:
- PANTONE Red 032 C
- CutContour (칼선)
- Crease (접선)
- 기타 사용자 정의 별색

---

## 7. 후가공 파일 검증

| 항목 | 허용 | 불허 |
|------|------|------|
| 별색(Spot Color) | ✅ CutContour, Crease 등 | - |
| CMYK 잉크 사용 | - | ❌ 오류 발생 |
| K(Black) 단독 | - | ❌ 오류 발생 |

> **규칙**: 후가공 파일(post_process)은 **순수 별색만** 허용됩니다.
> CMYK 잉크가 0.1%라도 감지되면 오류 처리됩니다.

---

## 8. 투명도/오버프린트 감지

| 항목 | 감지 대상 | 처리 |
|------|-----------|------|
| 투명도 | /ca, /CA, /BM (블렌드 모드) | ⚠️ 경고 |
| 오버프린트 | /OP, /op, /OPM | ⚠️ 경고 |

**경고 메시지**:
- 투명도: "투명도 효과가 포함되어 있습니다. 인쇄 시 예상과 다른 결과가 나올 수 있습니다."
- 오버프린트: "오버프린트 설정이 포함되어 있습니다. 인쇄 시 색상이 혼합될 수 있습니다."

---

## 9. 이미지 해상도 검증

| 기준 | 처리 |
|------|------|
| 150 DPI 이상 | ✅ 정상 |
| 150 DPI 미만 | ⚠️ 저해상도 경고 |

---

## 오류(Error) vs 경고(Warning) 기준

| 처리 | 조건 | 결과 |
|------|------|------|
| ❌ **오류 (차단)** | 후가공 파일 + CMYK 사용 | 접수 불가 |
| ❌ **오류 (차단)** | 사철 페이지 수 위반 | 접수 불가 |
| ❌ **오류 (차단)** | 페이지 규격 불일치 | 접수 불가 |
| ⚠️ **경고 (확인)** | CMYK 색상 감지 | 고객 확인 후 진행 |
| ⚠️ **경고 (확인)** | 투명도/오버프린트 | 고객 확인 후 진행 |
| ⚠️ **경고 (확인)** | 가로형 페이지 | 고객 확인 후 진행 |

---

## API 응답 예시

```json
{
  "isValid": true,
  "errors": [],
  "warnings": [
    {
      "code": "TRANSPARENCY_DETECTED",
      "message": "투명도 효과가 포함되어 있습니다."
    }
  ],
  "metadata": {
    "pageCount": 1,
    "pageSize": { "width": 210, "height": 297 },
    "colorMode": "RGB",
    "hasSpotColors": true,
    "spotColors": ["CutContour", "Crease"],
    "hasTransparency": true,
    "hasOverprint": false
  }
}
```

---

## 에러/경고 코드 목록

### 에러 코드 (ErrorCode)

| 코드 | 설명 |
|------|------|
| `UNSUPPORTED_FORMAT` | 지원하지 않는 파일 형식 |
| `FILE_CORRUPTED` | 손상된 파일 |
| `FILE_TOO_LARGE` | 파일 크기 초과 |
| `PAGE_COUNT_INVALID` | 페이지 수 오류 (제본 방식에 맞지 않음) |
| `PAGE_COUNT_EXCEEDED` | 페이지 수 초과 |
| `SIZE_MISMATCH` | 페이지 사이즈 불일치 |
| `SPINE_SIZE_MISMATCH` | 책등 사이즈 불일치 |
| `SADDLE_STITCH_INVALID` | 사철 제본 규격 오류 (4의 배수 아님) |
| `POST_PROCESS_CMYK` | 후가공 파일에 CMYK 색상 사용 |
| `SPREAD_SIZE_MISMATCH` | 스프레드 사이즈 불일치 |

### 경고 코드 (WarningCode)

| 코드 | 설명 |
|------|------|
| `PAGE_COUNT_MISMATCH` | 페이지 수 불일치 (주문과 다름) |
| `BLEED_MISSING` | 재단 여백 없음 |
| `RESOLUTION_LOW` | 해상도 낮음 |
| `LANDSCAPE_PAGE` | 가로형 페이지 감지 |
| `CENTER_OBJECT_CHECK` | 사철 제본 중앙부 객체 확인 필요 |
| `CMYK_STRUCTURE_DETECTED` | CMYK 구조 감지 |
| `MIXED_PDF` | 혼합 PDF (표지+내지 다른 규격) |
| `TRANSPARENCY_DETECTED` | 투명도 감지 |
| `OVERPRINT_DETECTED` | 오버프린트 감지 |

---

## 면책 조항

> ⚠️ 본 자동 검수 시스템은 기술적 규격 검증을 보조하는 도구입니다.
> 실제 인쇄 품질을 보장하지 않으며, 최종 확인은 인쇄소 담당자가 진행합니다.
