# 인쇄 쇼핑몰 워커 & 편집기 시스템 PRD
## Product Requirements Document

**문서 버전:** 1.6
**작성일:** 2025-12-03
**최종 업데이트:** 2025-12-03
**변경 이력:**
- v1.0: 초안 작성 (PDF 분석 기반)
- v1.1: 회의록 반영 (셀프 편집 케이스, UI 연동, 토큰 관리 등)
- v1.2: 워커 아키텍처 변경 (클라이언트 설치형 → 서버 서비스)
- v1.3: 전체 시스템 구조 명확화 (기존 쇼핑몰 + 신규 3개 컴포넌트)
- v1.4: 시스템 명칭 정리 (클라이언트 관련 표기 제거)
- v1.5: 템플릿 생성/관리 기능 상세화 (편집기 통한 생성, 3차 카테고리 뎁스)
- v1.6: 주요 의사결정 사항 확정 (워커/편집기 독립성, 템플릿셋 변경 정책, 콜백 방식)

**프로젝트명:** 인쇄 쇼핑몰 워커 & 편집기 시스템
**개발사:** (주)파파스컴퍼니
**클라이언트:** 북모아 (현재 인쇄 서비스 운영 중)

---

## 1. 제품 개요

### 1.1 프로젝트 목적
기존 인쇄 쇼핑몰에 편집기, 편집기 관리자, 워커(PDF 검증/합성) 서비스를 추가하여 고객의 온라인 편집 및 자동화된 파일 처리 기능 제공

### 1.2 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────────┐
│                  인쇄 쇼핑몰 통합 시스템                      │
└─────────────────────────────────────────────────────────────┘

┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
│  기존 시스템      │  │  신규 개발 (1)   │  │  신규 개발 (2)   │
│                  │  │                  │  │                  │
│  인쇄 쇼핑몰     │◄─┤  편집기          │◄─┤  편집기 관리자   │
│  (PHP)           │  │  (React)         │  │  (React)         │
│                  │  │                  │  │                  │
│  - 상품 관리     │  │  - 표지 편집     │  │  - 템플릿 관리   │
│  - 주문 관리     │  │  - 내지 편집     │  │  - 라이브러리    │
│  - 회원 관리     │  │  - 임시저장      │  │  - 워커 설정     │
│  - 결제 처리     │  │  - PDF Export    │  │  - 사이트 설정   │
└────────┬─────────┘  └────────┬─────────┘  └──────────────────┘
         │                     │
         │ API 호출            │ API 호출
         ▼                     ▼
┌─────────────────────────────────────────┐
│          신규 개발 (3)                  │
│                                         │
│          워커 서비스                    │
│          (서버 서비스)                  │
│                                         │
│  - PDF 파일 검증                        │
│  - PDF 파일 합성/변환                   │
│  - Before/After 미리보기 생성           │
│  - 블리드 처리                          │
│  - 페이지 자동 채움                     │
└─────────────────────────────────────────┘
```

### 1.3 기존 시스템 (유지)

#### 1.3.1 인쇄 쇼핑몰 (PHP 기반)
- **현황**: 운영 중
- **기술 스택**: PHP
- **인프라**: 온프레미스 (On-Premise) 단일 서버
- **기능**:
  - 상품 등록/관리
  - 주문 접수/처리
  - 회원 관리
  - 결제 시스템
  - 마이페이지
- **역할**: 비즈니스 로직 및 주문 처리의 중심

### 1.4 신규 개발 컴포넌트

#### 1.4.1 편집기 (React 기반 웹 애플리케이션)
- **목적**: 고객이 온라인에서 표지/내지를 직접 편집
- **주요 기능**:
  - 표지 디자인 편집
  - 내지 편집/미리보기
  - 템플릿 기반 편집
  - 임시 저장
  - PDF Export
- **연동**:
  - 쇼핑몰: 주문 옵션 전달, 편집 결과 반환
  - 워커: 파일 검증/변환 요청

#### 1.4.2 편집기 관리자 (React 기반 관리 도구)
- **목적**: 편집기 운영에 필요한 리소스 및 설정 관리
- **주요 기능**:
  - 템플릿 분류/관리
  - 템플릿셋 관리
  - 라이브러리 관리 (폰트, 배경, 도형, 클립아트)
  - 워커 설정 관리
  - 사이트별 설정
- **접근**: 별도 관리자 전용 URL

#### 1.4.3 워커 서비스 (서버 기반 백그라운드 서비스)
- **목적**: PDF 파일 검증, 합성, 변환 자동화
- **배포 환경**: 쇼핑몰과 동일한 온프레미스 서버
- **주요 기능**:
  - 파일 검증 (사이즈, 페이지수, 폰트, 이미지, 색상)
  - 파일 변환 (블리드 처리, 페이지 자동 채움)
  - PDF 합성
  - Before/After 미리보기 생성
- **호출 방식**: REST API
- **처리 방식**: Queue 기반 비동기 처리

### 1.5 시스템 연동 관계

```
┌─────────────────────────────────────────────────────────┐
│                      사용자 (고객)                       │
└────────────────┬────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────┐
│            인쇄 쇼핑몰 (PHP) - 기존 시스템              │
│                                                         │
│  주문 페이지 → [셀프 편집 버튼] → 편집기 임베딩         │
└────┬────────────────────────────────────┬──────────────┘
     │                                    │
     │ 1. 주문 옵션 전달                  │ 3. PDF 파일 검증 요청
     │ (사이즈, 페이지수, 제본방식 등)     │    (표지/내지 PDF)
     │                                    │
     ▼                                    ▼
┌─────────────────────────────┐    ┌──────────────────────┐
│  편집기 (React)             │    │  워커 서비스         │
│                             │    │  (서버 서비스)       │
│  - 표지/내지 편집           │◄──►│                      │
│  - 임시저장                 │    │  - 파일 검증         │
│  - PDF Export               │    │  - 파일 변환         │
└─────────────┬───────────────┘    │  - 합성              │
              │                    └──────────────────────┘
              │ 2. 편집 완료 콜백
              │ (페이지수, 파일 경로)
              │
              ▼
┌─────────────────────────────────────────────────────────┐
│            쇼핑몰 (주문 계속 진행)                       │
└─────────────────────────────────────────────────────────┘

         [관리자]
              │
              ▼
┌─────────────────────────────────────────────────────────┐
│          편집기 관리자 (React)                           │
│                                                         │
│  - 템플릿 관리 → 편집기에서 사용                        │
│  - 라이브러리 관리 → 편집기에서 사용                    │
│  - 워커 설정 → 워커 서비스 설정                         │
└─────────────────────────────────────────────────────────┘
```

### 1.6 개발 범위 요약

| 컴포넌트 | 개발 여부 | 기술 스택 | 비고 |
|----------|-----------|-----------|------|
| 인쇄 쇼핑몰 | 유지 | PHP | 기존 운영 중 |
| 편집기 | **신규 개발** | React | 쇼핑몰에 임베딩 |
| 편집기 관리자 | **신규 개발** | React | 별도 관리자 URL |
| 워커 서비스 | **신규 개발** | Node.js/Python | 서버 서비스 |

### 1.7 개발 요구사항
- 개발서버에 에디터 연동/시연을 위한 서버 구성 필요
- **편집기 반응형 지원 필수** (모바일/태블릿/데스크톱)
  - 디자인 수정 작업 진행 예정
- 기존 쇼핑몰과의 원활한 연동
  - 쇼핑몰 페이지에 React 편집기 임베딩
  - 주문 데이터 양방향 전달

---

## 2. 사용자 유형 및 Use Cases

### 2.1 책자 주문 고객 유형

| 유형 | 설명 | 파일 보유 현황 |
|------|------|----------------|
| UC-1 | 내지 파일을 직접 편집한 고객 | 내지 PDF |
| UC-2 | 내지+표지 파일 보유 고객 | 표지 PDF + 내지 PDF |
| UC-3 | '창조와지식' 저자 회원 | 내지 PDF |
| UC-4 | '꿈꾸는작가' 실시간 편집 고객 | 편집기 사용 |
| UC-5 | 일반 회원 (편집기) | 편집기 사용 |
| UC-6 | 일반 회원 (인쇄데이터) | PDF 파일 보유 |
| UC-7 | 표지 디자인 대행 요청 고객 | 내지 PDF만 보유 |
| UC-8 | 출판계약 작가 | 내지 파일만 보유 |

### 2.2 디지털인쇄 상품 주문 고객 유형

| 유형 | 설명 | 파일 보유 현황 |
|------|------|----------------|
| UC-9 | 작업파일 보유 고객 | AI/PDF/EPS/JPG 등 |
| UC-10 | 작업파일 미보유 고객 | 템플릿 사용 |

---

## 3. 워커(Worker) 시스템

### 3.1 아키텍처

#### 3.1.1 서버 서비스 구조
- **배포 방식**: 서버에 서비스로 배포 (클라이언트 설치 불필요)
- **실행 환경**: 백엔드 서버
- **호출 방식**: REST API
- **처리 방식**: 비동기 처리 (Queue 기반)

#### 3.1.2 주요 구성요소
```
┌─────────────────────────────────────┐
│         쇼핑몰 / 편집기             │
└──────────────┬──────────────────────┘
               │ API 호출
               ▼
┌─────────────────────────────────────┐
│      Worker Service (서버)          │
│  ┌───────────────────────────────┐  │
│  │  파일 검증 엔진               │  │
│  │  - 사이즈/페이지수 검증       │  │
│  │  - 폰트/이미지 검증           │  │
│  │  - 색상 모드 검증             │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │  파일 변환 엔진               │  │
│  │  - PDF 변환                   │  │
│  │  - 블리드 처리                │  │
│  │  - 페이지 자동 채움           │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │  미리보기 생성기              │  │
│  │  - Before/After 썸네일        │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│       파일 스토리지 (S3/NAS)        │
└─────────────────────────────────────┘
```

### 3.2 기본 기능

#### 3.2.1 파일 검증 모드
- **기능**: AI, PSD, JPG, EPS, PDF 파일 객체 검증 후 결과 반환
- **대상 파일 형식**: AI, PSD, JPG, EPS, PDF
- **검증 항목**:
  - 표지 사이즈, 세네카(책등), 책날개 사이즈
  - 내지 사이즈, 페이지수 (2p, 4p 조건)
  - 파일 무결성
  - 작업선, 재단선, 안전선 체크

#### 3.2.2 자동 변환 모드
- **기능**: 파일 자동 변환 및 처리
- **출력**:
  - 자동변환 처리내역 반환
  - 전/후 미리보기 썸네일 이미지 생성
  - Before/After 컨펌 기능

### 3.3 워커 API 명세

#### 3.3.1 파일 검증 API

**엔드포인트**:
```
POST /api/worker/validate
```

**요청**:
```javascript
{
  fileUrl: "https://storage.example.com/uploads/file.pdf",
  fileType: "cover" | "content",
  orderOptions: {
    size: {width: 210, height: 297},
    pages: 100,
    binding: "perfect",
    bleed: 3
  }
}
```

**응답**:
```javascript
{
  status: "success" | "error",
  validationResult: {
    size: {valid: true, message: "사이즈 정상"},
    pages: {valid: true, actual: 100, expected: 100},
    fonts: {valid: true, message: "모든 폰트 임베딩됨"},
    images: {valid: true, message: "이미지 포함 확인"},
    colorMode: {valid: true, mode: "CMYK"}
  },
  errors: [],
  warnings: ["블리드 영역 부족"]
}
```

#### 3.3.2 파일 변환 API

**엔드포인트**:
```
POST /api/worker/convert
```

**요청**:
```javascript
{
  fileUrl: "https://storage.example.com/uploads/file.pdf",
  convertOptions: {
    addPages: true,      // 페이지 자동 채움
    applyBleed: true,    // 블리드 적용
    targetPages: 104     // 목표 페이지수
  }
}
```

**응답**:
```javascript
{
  status: "success",
  convertedFileUrl: "https://storage.example.com/converted/file.pdf",
  beforePreview: "https://cdn.example.com/preview/before.jpg",
  afterPreview: "https://cdn.example.com/preview/after.jpg",
  changes: {
    pagesAdded: 4,
    bleedApplied: true
  }
}
```

### 3.4 워커 파일 검증 프로세스

```
파일 업로드 (쇼핑몰/편집기)
    ↓
API 호출: POST /api/worker/validate
    ↓
워커 서비스 실행
    ↓
파일 형식 검증 (AI/EPS/PNG/JPG/PDF)
    ↓
규격 검증
    ├─ 책자: 표지사이즈, 세네카, 내지사이즈
    └─ 디지털인쇄: 작업/재단사이즈, 후가공
    ↓
파일 무결성 검증
    ↓
결과 반환 (JSON)
    ├─ 오류 → 에러 메시지 반환
    └─ 정상 → 검증 결과 반환
    ↓
필요시 변환 API 호출
    ↓
변환된 파일 URL 반환
```

### 3.5 워커 관리자 설정

| 설정 항목 | 옵션 | 설명 |
|-----------|------|------|
| 사이트명 | 텍스트 입력 | 워커가 적용될 사이트 |
| 사이트 URL | URL 입력 | 사이트 주소 |
| 업로드 URL | URL 입력 | 파일 업로드 경로 |
| 워커 인증코드 | 코드 입력 | 인증 코드 |
| 운영여부 | 운영중/운영중지 | 워커 활성화 여부 |
| PDF 변환 여부 | 사용/사용안함 | PDF 자동 변환 |
| Before/After URL | URL 입력 | 미리보기 URL |
| 데이터 단위 | 밀리미터/인치 | 측정 단위 |
| 작업선 체크 | 사용/사용안함 | 작업선 표시 |
| 재단선 체크 | 사용/사용안함 | 재단선 표시 |
| 안전선 체크 | 사용/사용안함 | 안전선 표시 |

### 3.6 워커 배포 및 운영 (결정사항)

#### 3.6.1 배포 방식 결정
**기존 검토사항**:
- ~~옵션 1: 클라이언트 로컬 설치형 애플리케이션~~
- ~~옵션 2: 서버 서비스~~

**최종 결정**: ✅ **서버 서비스로 개발**

**결정 이유**:
1. 클라이언트 설치 및 업데이트 부담 제거
2. 중앙 집중식 관리 용이
3. 확장성 및 유지보수 효율성
4. API 기반으로 편집기와 쉽게 연동

#### 3.6.2 서버 요구사항
- **서버 환경**: Linux (Ubuntu 20.04 이상 권장)
- **필요 리소스**:
  - CPU: 4 Core 이상
  - RAM: 8GB 이상
  - Storage: 500GB 이상 (파일 처리용)
- **의존성**:
  - Node.js / Python (파일 처리 엔진에 따라)
  - ImageMagick / Ghostscript (PDF 처리)
  - 폰트 라이브러리

#### 3.6.3 확장성
- Queue 기반 처리 (Redis / RabbitMQ)
- 수평 확장 가능 (여러 워커 인스턴스)
- 로드 밸런싱 지원

---

## 4. 편집기(Editor) 시스템

### 4.1 편집기 구동 모드

#### 4.1.1 모드 1: 표지편집 + 내지 PDF 업로드
- 표지는 편집기로 온라인 직접 편집
- 내지는 PDF 파일의 사이즈, 매수, 객체검사 후 편집기에서 편환

#### 4.1.2 모드 2: 표지 PDF 업로드 + 내지 PDF 업로드
- 주문시 선택한 표지규격, 세네카사이즈, 책날개 사이즈 체크/변환
- 주문시 선택한 내지규격, 사이즈, 페이지수(2p, 4p 조건) 체크/변환

#### 4.1.3 모드 3: 책자 편집모드
- 등록된 템플릿 제공
- 일반적인 포토북 편집기능 제공
- 오픈폰트 중 선택적으로 제공
- 결과파일 JPG/EPS/PDF 선택 저장

#### 4.1.4 모드 4: 낱장 편집모드
- 상품별 기본 템플릿 제공
- **개발 일정**: 2025년 1월 말

### 4.2 편집기 구동 방식 (확정)

**처리 플로우**:
1. **파일 업로드 및 검증 단계** (편집기 구동 전)
   - 고객이 파일을 업로드
   - 워커 API로 파일 검증 수행
   - 검증 결과 확인
2. **편집 필요 여부 판단**
   - 편집이 필요한 경우 → 편집기 구동
   - 편집이 필요 없는 경우 → 바로 주문 진행
3. **편집기와 워커의 관계**
   - 편집기와 워커는 별도의 독립적인 서비스
   - 워커는 API 방식으로 제공
   - 편집기는 필요시에만 구동

**요구사항**:
- 표지파일/내지파일 중 첨부된 파일이 있는지 체크하여 편집기 구동 모드 자동 선택
- 주문정보에서 선택한 옵션 조합에 대한 정보를 편집기가 받아서 체크할 수 있도록 데이터 전달 필요

**파일 형식**:
- 책자 주문 표지 파일: PDF / AI / JPG / EPS / INDD
- 책자 주문 내지 파일: PDF

### 4.3 셀프 편집 주문 케이스별 처리 방식

#### 4.3.1 케이스 1: 표지 O, 내지 O (파일 보유)

**처리 흐름**:
```
파일 업로드 (표지 + 내지)
    ↓
검증
    ├─ 표지 검증 (사이즈, 블리드, 날개, 책등)
    └─ 내지 검증 (페이지수, 사이즈, 폰트, 이미지, 색상)
    ↓
변환
    ├─ 표지 변환 (블리드 처리, 날개/책등 조정)
    └─ 내지 변환 (페이지 자동 채움, 사이즈 조정)
    ↓
주문 완료
```

#### 4.3.2 케이스 2: 표지 X, 내지 O (내지만 보유)

**처리 흐름**:
```
편집기 오픈
    ↓
표지 편집
    ├─ 편집기에서 표지 디자인
    └─ 내지는 미리보기만 제공
    ↓
내지 처리
    ├─ 검증 (상세 항목은 4.3.3 참조)
    └─ 변환 (상세 항목은 4.3.4 참조)
    ↓
주문 완료
```

**편집기 처리 방식**:
- 표지: 편집 기능 제공
- 내지: 미리보기만 제공 (편집 불가)

#### 4.3.3 내지 파일 검증 항목 (상세)

| 검증 항목 | 검증 내용 | 참조 기준 |
|-----------|-----------|-----------|
| **페이지수** | 페이지수 일치 여부 | 웹에서 고객이 선택한 페이지수<br>- 상품설정 옵션<br>- 2판 걸이/4판 걸이 |
| **사이즈** | 허용 오차 내 사이즈 확인 | 예: A4 규격 (210x297mm)<br>- 허용 오차 범위 내 |
| **폰트** | 폰트 임베딩 확인 | 윤곽선 처리 여부 |
| **이미지** | 이미지 포함 여부 | 이미지 임베딩 확인 |
| **색상** | 색상 모드 확인 | CMYK 색상 모드 |

#### 4.3.4 내지 파일 변환 항목 (상세)

| 변환 항목 | 변환 내용 | 비고 |
|-----------|-----------|------|
| **페이지수** | 모자른 페이지 자동 채움 | 빈 페이지 추가 |
| **사이즈** | 블리드(Bleed) 영역 처리 | - 대지 밖으로 늘임<br>- 가운데 정렬 |

#### 4.3.5 케이스 3: 표지 X, 내지 X (파일 없음)

**처리 흐름**:
```
편집기 오픈
    ↓
표지/내지 편집 분리
    ├─ 표지 편집
    └─ 내지 편집
    ↓
결과물 생성
    ├─ 표지 파일 (별도)
    └─ 내지 파일 (별도)
    ↓
주문 완료
```

**편집 방식**:
- 페이지수 제한 설정
- 표지 편집과 내지 편집 분리
  - 선택 버튼으로 전환
- 결과물도 분리 생성
  - 표지 파일 따로
  - 내지 파일 따로

---

## 5. 주문 워크플로우

### 5.1 전체 주문 플로우

```
고객 유형 선택
    ↓
파일 업로드 OR 편집기 실행
    ↓
    ├─ [워커 경로] PDF 파일 업로드
    │       ↓
    │   워커 구동 (파일 검증)
    │       ↓
    │   검증 결과
    │       ├─ 오류 → 고객 노티 → Before/After 컨펌
    │       └─ 정상 → PDF 변환 파일 접수
    │
    └─ [편집기 경로] 셀프 편집 주문
            ↓
        편집기 구동
            ├─ 표지편집 O / 내지 PDF 첨부
            ├─ 표지편집 O / 내지편집 O
            └─ 템플릿 선택 O / 편집 O
            ↓
        편집기 PDF 변환 결과물 접수
    ↓
통합 주문관리
    ├─ 작업지시서 작성 필요 없음
    ├─ 고객이 선택한 정보 기반 주문접수
    ├─ 파일변환 필요 없음
    ├─ 검증된 데이터로 출력 대기상태 자동 전환
    └─ 작가주문/디자인의뢰 주문 구분/관리
    ↓
주문상태관리
    ├─ 접수완료
    ├─ 인쇄대기
    ├─ 인쇄중
    ├─ 제본/후공정
    ├─ 발송대기
    └─ 배송중/배송완료
```

### 5.2 케이스별 상세 플로우

#### 5.2.1 PDF 파일 업로드 주문 (표지/내지 보유)
```
PDF 파일 업로드
    ↓
워커 구동 파일검증
    ↓
워커 PDF 변환 파일 접수
    ↓
통합주문관리
```

#### 5.2.2 셀프 편집기 주문 (내지 파일만 보유)
```
셀프 편집 주문 선택
    ↓
편집기 구동
    ↓
표지편집 O / 내지 PDF 첨부
    ↓
편집기 PDF 변환 결과물 접수
    ↓
통합주문관리
```

#### 5.2.3 셀프 편집기 주문 (표지/내지 없음)
```
셀프 편집 주문 선택
    ↓
편집기 구동
    ↓
표지편집 O / 내지편집 O
    ↓
임시저장 (선택)
    ↓
편집완료
    ↓
통합주문관리
```

#### 5.2.4 디지털인쇄 상품 주문 (작업파일 없음)
```
디지털인쇄 상품 주문
    ↓
편집기 구동 (템플릿 선택)
    ↓
디지털인쇄 상품별 템플릿 구동
    ↓
편집기 PDF 변환 결과물 접수
    ↓
통합주문관리
```

#### 5.2.5 출판계약 작가 주문
```
PDF 파일 업로드
    ↓
주문접수 화면에서 관리자 컨펌
    ↓
표지/내지 파일 수기검증 및 디자인
    ↓
통합주문관리
```

### 5.3 주문 플로우 색상 구분

| 색상 | 의미 |
|------|------|
| 🟨 노란색 | 편집기/워커 구동 없이 주문하는 고객 플로우 |
| 🟪 분홍색 | 편집기 구동시 템에서 조건을 받아서 실행됨 |
| 🟦 파란색 | 워커 실행 후 파일 오류 체크/피드백 진행<br>주문상품의 사이즈, 매수, 후공정파일 등 체크 |

---

## 6. 관리자 시스템

### 6.1 메뉴 구조

```
Storige (관리자)
├─ 기본설정
├─ 편집기관리
├─ 템플릿분류
├─ 템플릿관리
├─ 템플릿셋관리
├─ 라이브러리
├─ 편집데이터관리
├─ 워커관리
├─ 워커데이터관리
└─ 클립아트관리
```

### 6.2 기본설정

#### 6.2.1 사이트 관리
- 사이트명
- 사이트 URL
- 보관함 URL
- 편집기 인증코드
- 사이트 운영여부: 운영중/운영중지

**등록 사이트 예시**:
- 메인 쇼핑몰
- 점보포토
- 스튜디오북
- 스토리워크

### 6.3 편집기관리

**상태**: 편집기 기본 설정이 필요한지 편집기 확인 후 정리 예정

### 6.4 템플릿분류

#### 6.4.1 카테고리 구조
**계층 구조**: 3차 뎁스까지 지원
- 1차 카테고리 (대분류, 2자리 코드)
- 2차 카테고리 (중분류, 3자리 코드)
- 3차 카테고리 (소분류, 3자리 코드)

#### 6.4.2 카테고리 예시

**디지털 책자** (1차)
├─ 무선제본 책자 (2차)
│  ├─ A4 사이즈 (3차)
│  └─ A5 사이즈 (3차)
└─ 사철제본 책자 (2차)
   ├─ A4 사이즈 (3차)
   └─ B5 사이즈 (3차)

**포토북** (1차)
├─ 정방형 포토북 (2차)
│  ├─ 8x8 인치 (3차)
│  └─ 10x10 인치 (3차)
└─ 세로형 포토북 (2차)
   └─ A5 세로 (3차)

**명함** (1차)
└─ 디지털명함 (2차)
   ├─ 일반 명함 (3차)
   └─ 고급 명함 (3차)

**셀프편집 상품** (1차)
├─ 여행책 (2차)
│  └─ A4 여행책 (3차)
├─ 학급문집 (2차)
│  └─ A5 학급문집 (3차)
└─ 연간포토북 (2차)
   └─ 8x8 연간포토북 (3차)

#### 6.4.3 카테고리 설정 항목

| 항목 | 옵션 | 설명 |
|------|------|------|
| 카테고리 코드 | 자동생성 | 1차: 2자리 / 2차: 3자리 / 3차: 3자리 |
| 카테고리명 | 입력폼 | 카테고리 이름 |
| 페이지 표기 | 페이지/전면/후면/앞/뒤 | 템플릿 유형별 표기방식 |
| 단위 구분 | 밀리미터(mm)/인치(inch) | 측정 단위 |
| 작업선 사용여부 | 사용/미사용 | 작업선 표시 설정 |
| 재단선 사용여부 | 사용/미사용 | 재단선 표시 설정 |
| 안전선 사용여부 | 사용/미사용 | 안전선 표시 설정 |
| 워터마크 사용여부 | 사용/미사용 | 현 개발단계 미적용 (추후) |
| 에디터 워터마크 | 사용/미사용 | 현 개발단계 미적용 (추후) |

#### 6.4.4 카테고리 관리 기능
1. 1차 카테고리 등록 버튼
2. 2차 카테고리 등록 버튼 (1차 선택시 활성화)
3. 3차 카테고리 등록 버튼 (2차 선택시 활성화)
4. 카테고리 위/아래 이동 (드래그앤드롭 또는 버튼)
5. 카테고리 수정
6. 카테고리 삭제
   - 하위 카테고리 존재시 하위 카테고리 우선 삭제 후 가능
   - 해당 카테고리에 템플릿이 등록된 경우 삭제 불가 또는 경고 표시

### 6.5 템플릿관리

#### 6.5.1 템플릿 생성

**생성 방식**: 관리자가 편집기를 통해 직접 템플릿 생성

**생성 프로세스**:
1. 템플릿 관리 메뉴에서 "신규 템플릿 생성" 버튼 클릭
2. 템플릿 기본 정보 입력
   - 템플릿명
   - 카테고리 선택 (1차 > 2차 > 3차)
   - 판형/사이즈 설정
   - 페이지수 설정
   - 사용여부 설정
3. "편집기로 디자인하기" 버튼 → 편집기 구동
4. 편집기에서 템플릿 디자인 작업
   - 텍스트, 이미지, 도형 등 배치
   - 라이브러리 리소스 활용
   - 레이어 구성
5. 편집 완료 후 "템플릿으로 저장"
6. 템플릿 코드 자동 생성
7. 템플릿 목록에 등록 완료

**템플릿 생성시 설정 항목**:
- 잠금 레이어: 사용자가 편집할 수 없는 레이어 지정
- 편집 가능 영역: 사용자가 편집할 수 있는 영역 지정
- 기본 리소스: 템플릿에 포함될 기본 폰트, 이미지 등

#### 6.5.2 템플릿 조회 화면

**상단 액션**:
- 신규 템플릿 생성 버튼
- 검색 필터 영역

**검색 필터**:
- 1차 카테고리 선택
- 2차 카테고리 선택
- 3차 카테고리 선택
- 템플릿명
- 사용여부: 전체/사용중/미사용

**표시 항목**:
- 템플릿 썸네일 (미리보기 이미지)
- 템플릿분류 (1차 > 2차 > 3차)
- 편집코드 (쇼핑몰 상품에 등록하여 편집기 호출)
- 템플릿코드
- 템플릿명
- 사용여부
- 등록일
- 수정일
- 등록자

**관리 기능**:
- 미리보기: 템플릿 미리보기 팝업
- 수정: 템플릿 수정 → 편집기 구동
- 복사: 템플릿 복사 (새 템플릿명으로 복제)
- 삭제: 템플릿 삭제
- 선택삭제: 다중 선택 삭제
- 사용여부 토글: 사용중/미사용 상태 변경

#### 6.5.3 템플릿 수정

**수정 프로세스**:
1. 템플릿 목록에서 "수정" 버튼 클릭
2. 템플릿 기본 정보 수정 가능
3. "편집기로 수정하기" 버튼 → 편집기 구동 (기존 템플릿 데이터 로드)
4. 편집기에서 템플릿 수정
5. "저장" → 기존 템플릿 업데이트

**버전 관리** (선택사항):
- 템플릿 수정시 버전 히스토리 저장
- 이전 버전으로 복원 기능

### 6.6 템플릿셋 관리

#### 6.6.1 템플릿셋 개념
규격/디자인/리소스 등이 지정된 상품 템플릿 세트

#### 6.6.2 템플릿셋 생성

**생성 방식**: 별도의 관리자 메뉴에서 생성 및 관리

**구성 주의사항**:
1. 템플릿 판형 세팅 필요 (상품군, 규격, 페이지수 등)
2. 등록된 라이브러리를 불러와서 구성
3. 템플릿명을 지정하여 구성요소 저장

**템플릿셋 변경시 처리 방안 (확정)**:

**결정**: 편집기 구동 후에는 템플릿셋 변경 불가
- 편집기는 가격에 관여하지 않음
- 가격 변경이 있는 요소는 편집기 구동 전/후에 관리
- 템플릿셋 변경이 필요한 경우 편집을 중단하고 주문 단계로 돌아가야 함

### 6.7 라이브러리

#### 6.7.1 라이브러리 구분

**1. 판형**
- 자동판형: 웹 주문정보의 사이즈를 받아서 자동생성
- 수동판형: 편집기 구동시 사용할 판형 선택

**2. 폰트**
- 사용가능한 폰트 라이브러리

**3. 배경**
- 편집상품 지정 배경
- 공용 라이브러리

**4. 도형**

**5. 프레임 (사진틀)**

**6. 클립아트**

**7. 큐알코드**

#### 6.7.2 라이브러리 설정 항목

| 항목 | 설명 |
|------|------|
| 카테고리 선택 | 라이브러리가 속할 카테고리 |
| 라이브러리명 | 라이브러리 이름 |
| 사용여부 | 사용중/미사용 |

### 6.8 편집데이터관리

#### 6.8.1 검색 필터
- 카테고리 선택
- 편집명
- 고객명/아이디
- 작업상태: 편집중/편집완료

#### 6.8.2 표시 항목
- 주문번호
- 편집코드
- 편집명
- 편집 시작일
- 마지막 수정일
- 편집 완료일

#### 6.8.3 관리 기능
- 편집 수정
- 복사
- 삭제

### 6.9 클립아트관리

#### 6.9.1 클립아트 카테고리 관리
- 카테고리 등록/수정/삭제
- 카테고리 순서 변경

#### 6.9.2 클립아트 등록
- 카테고리 선택
- 상위 카테고리 선택
- 파일 업로드
- 사용여부

#### 6.9.3 클립아트 목록
- 썸네일 미리보기
- 카테고리별 필터
- 검색 기능

---

## 7. 마이페이지 연동

### 7.1 마이페이지 구조

**URL**: https://bookmoa.noriter.co.kr/mypage22/main.html

**메뉴**:
- HOME
  - 주문
    - 일반주문
    - 주문내역
    - 현장상담
    - 취소내역
  - 결제
    - 이전 거래내역 조회
    - 거래내역 조회
    - 입출금 내역
    - 선입금 카드 결제
    - 계좌 관리
    - 계산서 관리
  - 상점
    - 견적내역
    - 1:1 문의
  - 회원
    - 회원정보 변경
    - 배송 관리
    - 최근 알림

### 7.2 편집보관함 추가 필요

**요구사항**:
- 편집보관함 추가 필요
- 좌측 사이드메뉴 내용 중 굿프린팅 이미지, 캡쳐화면 등 대체
- 캡쳐화면은 이미지 영역만 회색이미지로 잡아놓고 추후 수정

### 7.3 컨텐츠 수정 작업 분장

**관리자에서 정보수정 (개발) / 퍼블리싱수정 (퍼블리싱)**:
- 개발과 퍼블리싱에서 수정해야 할 부분 체크하여 공유
- 업무 분장해서 작업 진행

---

## 8. 기술 요구사항

### 8.1 파일 형식 지원

| 용도 | 지원 형식 |
|------|-----------|
| 책자 표지 | PDF, AI, JPG, EPS, INDD |
| 책자 내지 | PDF |
| 디지털인쇄 | AI, EPS, PNG, JPG, PDF |

### 8.2 파일 검증 항목

**책자**:
- 표지사이즈
- 세네카(책등)
- 내지사이즈
- 파일무결성
- 페이지수 (2p, 4p 조건)

**디지털인쇄**:
- 작업/재단사이즈
- 후가공
- 파일무결성

### 8.3 출력 파일 형식
- JPG
- EPS
- PDF

### 8.4 책등(세네카) 검증 상세

#### 8.4.1 책등 사이즈 계산
```
책등 사이즈 = 용지 두께 × 페이지수
```
- 용지 정보는 DB 연동하여 관리
- 용지별 두께 정보 필수

#### 8.4.2 표지 구성 요소

| 구성 요소 | 검증 항목 | 비고 |
|-----------|-----------|------|
| **앞면** | 사이즈, 블리드, 안전영역 | 필수 |
| **뒷면** | 사이즈, 블리드, 안전영역 | 필수 |
| **책등** | 용지 두께 × 페이지수로 계산된 사이즈 | 제본 방식에 따라 편집영역 달라짐 |
| **날개(앞)** | 선택한 날개 사이즈와 일치 | 옵션 |
| **날개(뒤)** | 선택한 날개 사이즈와 일치 | 옵션 |

#### 8.4.3 제본 방식별 편집 영역

| 제본 방식 | 편집 영역 특징 |
|-----------|----------------|
| 무선제본 | 책등 영역 편집 가능 |
| 사철제본 | 책등 영역 제한적 |

#### 8.4.4 Before/After 화면
- 11페이지 참조: Before/After 화면 필요
- 표지 전개도 미리보기 제공

### 8.5 블리드(Bleed) 처리

| 항목 | 처리 방식 |
|------|-----------|
| 블리드 영역 | 대지 밖으로 늘임 (일반적으로 3mm) |
| 정렬 방식 | 가운데 정렬 |
| 안전 영역 | 재단선 안쪽 3mm |

---

## 9. UI 연동 명세

### 9.1 쇼핑몰-편집기 연동 구조

#### 9.1.1 기술 스택
- **쇼핑몰**: PHP
- **편집기**: React
- **연동 방식**: 쇼핑몰에서 기본 페이지 구성, root element 하위에 React 구동

#### 9.1.2 통합 방식
```html
<!-- 쇼핑몰 페이지 (PHP) -->
<div id="editor-root"></div>
<script src="editor-bundle.js"></script>
```

### 9.2 편집기 오픈시 전달 데이터

#### 9.2.1 옵션 연동 데이터

| 옵션명 | 데이터 타입 | 설명 | 예시 |
|--------|-------------|------|------|
| `coverWing` | Object | 날개 정보 | `{front: 50, back: 50}` (mm) |
| `size` | Object | 사이즈 | `{width: 210, height: 297}` (mm) |
| `pages` | Number | 페이지수 | `100` |
| `bleed` | Number | 블리드 | `3` (mm) |
| `binding` | String | 제본방식 | `"perfect"` / `"saddle"` |
| `paper` | Object | 용지 정보 | `{type: "모조지", weight: 80, thickness: 0.1}` |
| `pageAddable` | Boolean | 페이지 추가 가능 여부 | `true` / `false` |
| `pageRange` | Object | 페이지 구간 정보 | `{min: 20, max: 200, step: 4}` |

#### 9.2.2 저장 코드 (편집 코드)
```javascript
{
  editCode: "EDIT-20251203-001",
  orderCode: "ORDER-20251203-001"
}
```

**편집 코드 용도**:
- 임시 저장 식별
- 편집 이력 관리
- 재편집시 불러오기

### 9.3 편집기 종료시 콜백 데이터

#### 9.3.1 반환 데이터

```javascript
{
  // 페이지수 정보
  pages: {
    initial: 100,      // 시작 페이지수
    final: 104         // 최종 페이지수
  },

  // 저장 정보
  editCode: "EDIT-20251203-001",
  savedAt: "2025-12-03T10:30:00Z",

  // 파일 정보
  files: {
    cover: "/path/to/cover.pdf",
    content: "/path/to/content.pdf"
  }
}
```

#### 9.3.2 콜백 방식

**옵션 1: Callback 함수**
```javascript
window.onEditorClose = function(data) {
  // 쇼핑몰에서 처리
  updateOrderPages(data.pages.final);
  saveEditCode(data.editCode);
};
```

**옵션 2: Webhook**
```javascript
POST /api/editor/callback
{
  editCode: "EDIT-20251203-001",
  pages: { initial: 100, final: 104 },
  ...
}
```

### 9.4 관리자 페이지

- 별도 오픈 (독립적인 애플리케이션)
- 쇼핑몰과 분리된 인증 체계
- React 기반 SPA

### 9.5 사용자 인증 및 토큰 관리

#### 9.5.1 로그인 API

**엔드포인트**:
```
POST /api/auth/login
```

**요청**:
```javascript
{
  username: "user@example.com",
  password: "******"
}
```

**응답**:
```javascript
{
  accessToken: "eyJhbGc...",
  expiresIn: 604800  // 1주일 (초 단위)
}
```

#### 9.5.2 토큰 관리

| 항목 | 값 | 비고 |
|------|-----|------|
| **AccessToken** | JWT | API 요청시 사용 |
| **만료기간** | 1주일 (604800초) | 설정 가능 |
| **RefreshToken** | ~~사용~~ **삭제** | 사용하지 않음 |
| **갱신 방식** | 재로그인 | 토큰 만료시 재로그인 필요 |

#### 9.5.3 토큰 관리 예제 소스

**제공 예정**:
- 토큰 저장 (LocalStorage / SessionStorage)
- API 요청시 토큰 헤더 추가
- 토큰 만료 처리
- 에러 핸들링

```javascript
// 예제 (제공 예정)
class AuthManager {
  static setToken(token) {
    localStorage.setItem('accessToken', token);
  }

  static getToken() {
    return localStorage.getItem('accessToken');
  }

  static clearToken() {
    localStorage.removeItem('accessToken');
  }

  static isTokenExpired() {
    // JWT 디코딩하여 만료 확인
  }
}
```

---

## 10. PDF 합성 및 Export API

### 10.1 PDF Export 기능

#### 10.1.1 Export 트리거
- 쇼핑몰에서 필요한 시점에 API 호출
- 비동기 처리 (백그라운드 작업)

#### 10.1.2 API 명세

**엔드포인트**:
```
POST /api/export/pdf
```

**요청**:
```javascript
{
  editCode: "EDIT-20251203-001",
  exportType: "cover" | "content" | "both",
  format: "pdf" | "jpg" | "eps"
}
```

**응답**:
```javascript
{
  status: "success",
  files: [
    {
      type: "cover",
      path: "/exports/EDIT-20251203-001/cover.pdf",
      url: "https://cdn.example.com/exports/EDIT-20251203-001/cover.pdf",
      size: 1024000  // bytes
    },
    {
      type: "content",
      path: "/exports/EDIT-20251203-001/content.pdf",
      url: "https://cdn.example.com/exports/EDIT-20251203-001/content.pdf",
      size: 5120000  // bytes
    }
  ],
  createdAt: "2025-12-03T10:30:00Z"
}
```

#### 10.1.3 파일 생성 경로
- **서버 경로**: `/var/www/exports/{editCode}/`
- **파일명 규칙**: `{type}_{timestamp}.{format}`
- **CDN URL**: 응답에 포함

#### 10.1.4 에러 처리

**에러 응답**:
```javascript
{
  status: "error",
  errorCode: "EXPORT_FAILED",
  message: "PDF 생성 중 오류가 발생했습니다.",
  details: {
    editCode: "EDIT-20251203-001",
    reason: "Invalid page count"
  }
}
```

**에러 코드**:
- `EDIT_NOT_FOUND`: 편집 코드를 찾을 수 없음
- `EXPORT_FAILED`: PDF 생성 실패
- `INSUFFICIENT_STORAGE`: 저장 공간 부족
- `INVALID_FORMAT`: 지원하지 않는 포맷

---

## 11. 주요 의사결정 필요 사항

### ✅ 11.1 워커 처리 방식 (확정)

**결정**: 워커는 편집기와 독립적인 별도 서비스로 제공

**처리 플로우**:
1. 고객이 파일 업로드
2. 워커 API로 파일 검증 (편집기 구동 전)
3. 검증 결과에 따라:
   - 편집 필요 → 편집기 구동
   - 편집 불필요 → 바로 주문 진행
4. 편집기 종료 후 최종 파일 → 워커 API로 변환/합성

**워커 역할**:
- 파일 검증 (사이즈, 페이지수, 폰트, 이미지, 색상)
- 파일 변환 (블리드, 페이지 자동 채움)
- PDF 합성
- Before/After 미리보기 생성

**편집기 역할**:
- 표지/내지 디자인 편집
- 템플릿 기반 편집
- 임시 저장
- PDF Export

**독립성**:
- 워커와 편집기는 각각 독립적인 API 서비스
- 편집기 없이 워커만 사용 가능 (파일 업로드 주문)
- 워커 없이 편집기만 사용 가능 (템플릿 기반 편집)

### ✅ 11.2 템플릿셋 변경시 처리 (확정)

**결정**: 편집기 구동 후에는 템플릿셋 변경 불가

**이유**:
- 편집기는 가격에 관여하지 않음
- 가격 변경이 있는 요소는 편집기 구동 전/후에 관리
- 템플릿셋 변경 = 주문 스펙 변경 = 가격 변경

**구현 방안**:
- 편집기 내에서 템플릿셋 변경 UI 제공 안 함
- 템플릿셋 변경이 필요한 경우 편집을 중단하고 주문 단계로 돌아가야 함

### ✅ 11.3 편집기-쇼핑몰 콜백 방식 (확정)

**결정**: Callback 방식을 기본으로 제공, Webhook은 옵션 제공

**구현 방안**:

1. **JavaScript Callback 방식** (기본)
```javascript
// 쇼핑몰에서 편집기 호출시 콜백 함수 등록
window.openEditor({
  orderId: "ORDER-12345",
  options: {...},
  onComplete: function(result) {
    // 편집 완료시 호출
    console.log("편집 완료:", result);
    // result = { editCode, pageCount, coverPath, contentPath }
  },
  onCancel: function() {
    // 편집 취소시 호출
    console.log("편집 취소");
  }
});
```

2. **Webhook API 방식** (옵션)
```javascript
// 편집기 설정에 webhook URL 지정
POST [WEBHOOK_URL]
{
  "event": "edit_complete",
  "orderId": "ORDER-12345",
  "editCode": "EDIT-20251203-001",
  "data": {
    "pageCount": 100,
    "coverPath": "/files/cover.pdf",
    "contentPath": "/files/content.pdf"
  }
}
```

**적용 시나리오**:
- Callback: 일반적인 동기 처리, 편집기가 쇼핑몰 페이지에 임베드된 경우
- Webhook: 비동기 처리, 별도 창에서 편집기 실행, 외부 시스템 연동

---

## 11-A. 확정된 의사결정 사항

### ✅ 1. 워커 배포 방식
**결정**: 서버 서비스로 개발 (클라이언트 설치형 X)

**이유**:
- 클라이언트 설치 및 업데이트 부담 제거
- 중앙 집중식 관리 및 확장성
- API 기반 연동의 편의성

**상세**: §3.6 참조

---

### ✅ 2. 워커와 편집기의 독립성
**결정**: 워커는 편집기와 독립적인 별도 API 서비스로 제공

**처리 순서**:
1. 파일 업로드 → 워커 검증 (편집기 구동 전)
2. 검증 결과에 따라 편집기 구동 여부 결정
3. 편집 완료 → 워커 변환/합성

**상세**: §11.1 참조

---

### ✅ 3. 템플릿셋 변경 정책
**결정**: 편집기 구동 후에는 템플릿셋 변경 불가

**이유**:
- 편집기는 가격에 관여하지 않음
- 가격 변경 요소는 편집기 구동 전/후에 관리

**상세**: §6.6.2, §11.2 참조

---

### ✅ 4. 편집기-쇼핑몰 연동 방식
**결정**: JavaScript Callback (기본) + Webhook (옵션)

**구현**:
- Callback: 동기 처리, 일반적인 사용 케이스
- Webhook: 비동기 처리, 외부 시스템 연동

**상세**: §11.3 참조

---

### ✅ 5. 템플릿셋 관리 방식
**결정**: 별도의 관리자 메뉴에서 생성 및 관리

**이유**: 템플릿셋은 관리자 권한 필요한 설정 작업

**상세**: §6.6 참조

---

## 12. 개발 우선순위 및 일정

### Phase 1: 핵심 워커 기능
- [ ] 워커 파일 검증 시스템
  - [ ] 표지 검증 (사이즈, 블리드, 날개, 책등)
  - [ ] 내지 검증 (페이지수, 사이즈, 폰트, 이미지, 색상)
- [ ] PDF 자동 변환 기능
  - [ ] 페이지 자동 채움
  - [ ] 블리드 영역 처리
- [ ] Before/After 미리보기 기능
- [ ] 고객 노티 시스템

### Phase 2: 편집기 기본 기능
- [ ] 표지 편집기
  - [ ] 반응형 UI (모바일/태블릿/데스크톱)
  - [ ] 날개/책등 자동 계산
- [ ] 내지 편집기 (미리보기)
- [ ] 템플릿 시스템
- [ ] 임시저장 기능
- [ ] UI 연동 (쇼핑몰-편집기)
  - [ ] 옵션 데이터 전달
  - [ ] 콜백/웹훅 처리

### Phase 3: 관리자 시스템
- [ ] 기본설정 관리
- [ ] 템플릿 분류/관리
- [ ] 라이브러리 관리
- [ ] 워커 관리
- [ ] 사용자 인증 및 토큰 관리

### Phase 4: 통합 및 최적화
- [ ] 주문 워크플로우 통합
- [ ] 통합주문관리 시스템
- [ ] 마이페이지 연동
- [ ] 편집보관함 기능
- [ ] PDF Export API

### Phase 5: 낱장 편집기 (2025년 1월 말)
- [ ] 낱장 상품 템플릿
- [ ] 낱장 편집 기능
- [ ] 낱장 검증/변환

---

## 13. 성공 지표 (KPI)

### 13.1 사용자 경험
- 파일 업로드 후 검증 완료까지 시간: < 30초
- 편집기 로딩 시간: < 5초
- 주문 완료율: > 85%
- 모바일 편집 성공률: > 80%

### 13.2 시스템 성능
- 파일 검증 정확도: > 95%
- 자동 변환 성공률: > 90%
- 시스템 가용성: > 99.5%
- PDF Export 성공률: > 98%

### 13.3 비즈니스
- 주문 처리 시간 단축: 50% 이상
- 고객 문의 감소: 30% 이상
- 재주문률 증가: 20% 이상
- 셀프 편집 주문 비율: 목표 40%

---

## 14. 다음 단계

1. **요구사항 검토 미팅**
   - 의사결정 필요 사항 논의
   - 기술적 구현 방안 검토
   - 개발 일정 협의
   - 회의록 내용 확인 및 추가 질의

2. **상세 설계**
   - API 명세서 작성 (완료)
   - 데이터베이스 스키마 설계
   - UI/UX 상세 설계
   - 반응형 디자인 작업

3. **기술 검증**
   - 쇼핑몰(PHP) - 편집기(React) 연동 PoC
   - 토큰 관리 예제 소스 작성 및 전달
   - PDF Export 기능 검증

4. **프로토타입 개발**
   - 개발서버 환경 구축
   - 핵심 기능 프로토타입
   - 사용자 테스트

5. **정식 개발**
   - Phase별 개발 진행
   - 지속적인 테스트
   - 피드백 반영

---

## 부록 A: 용어 정의

| 용어 | 정의 |
|------|------|
| 워커(Worker) | 서버 기반 파일 검증 및 자동 변환 서비스 (기존 클라이언트 설치형에서 변경) |
| 편집기(Editor) | React 기반 온라인 편집 도구 (웹 애플리케이션) |
| 세네카 | 책의 등(spine) 부분 |
| 책등 | 세네카와 동일 (책의 등 부분) |
| 책날개 | 표지의 접히는 부분 (flap) |
| 템플릿셋 | 특정 상품에 대한 템플릿, 라이브러리 등의 묶음 |
| 라이브러리 | 편집기에서 사용할 수 있는 리소스 (폰트, 배경, 도형 등) |
| 블리드(Bleed) | 재단시 여백을 위한 여분 영역 (일반적으로 3mm) |
| 안전 영역 | 재단선 안쪽의 안전한 편집 영역 |
| 2판 걸이 | 한 번에 2페이지씩 인쇄하는 방식 |
| 4판 걸이 | 한 번에 4페이지씩 인쇄하는 방식 |
| 편집 코드 | 편집 세션을 식별하는 고유 코드 |
| AccessToken | API 인증에 사용되는 JWT 토큰 |
| 무선제본 | 접착제로 붙이는 제본 방식 (Perfect Binding) |
| 사철제본 | 실로 꿰매는 제본 방식 (Saddle Stitch) |

---

## 부록 B: 회의록 반영 내역

### 2025-12-03 회의록 주요 반영 사항

1. **편집기 반응형 지원** (§1.3)
   - 모바일/태블릿/데스크톱 반응형 디자인 필수

2. **셀프 편집 주문 케이스별 처리** (§4.3)
   - 케이스 1: 표지 O, 내지 O
   - 케이스 2: 표지 X, 내지 O (내지 미리보기만 제공)
   - 케이스 3: 표지 X, 내지 X (편집 분리, 결과물 분리)

3. **내지 검증/변환 항목 상세화** (§4.3.3, §4.3.4)
   - 검증: 페이지수, 사이즈, 폰트, 이미지, 색상
   - 변환: 페이지 자동 채움, 블리드 영역 처리

4. **UI 연동 명세** (§9)
   - 쇼핑몰(PHP)-편집기(React) 연동 구조
   - 옵션 데이터 전달 (날개, 사이즈, 페이지수, 블리드, 제본방식, 용지 등)
   - 편집기 종료시 콜백/웹훅 처리

5. **사용자 토큰 관리** (§9.5)
   - 로그인 API 명세
   - RefreshToken 삭제 결정
   - 토큰 만료기간 1주일
   - 토큰 관리 예제 소스 제공 예정

6. **책등 검증 상세** (§8.4)
   - 책등 사이즈 = 용지 두께 × 페이지수
   - 용지 정보 DB 연동
   - 제본 방식별 편집영역 차이
   - Before/After 화면 제공

7. **낱장 편집기 일정** (§4.1.4)
   - 2025년 1월 말 목표

8. **PDF Export API** (§10)
   - API 엔드포인트 명세
   - 파일 생성 경로 및 규칙
   - 에러 처리 명세

### 2025-12-03 아키텍처 결정 사항

9. **워커 서버 서비스 변경** (§3.1, §3.6, §11-A)
   - 기존: 클라이언트 설치형 애플리케이션
   - 변경: 서버 기반 서비스 (REST API)
   - 워커 API 명세 추가 (검증 API, 변환 API)
   - 서버 요구사항 및 확장성 명세
   - Queue 기반 비동기 처리 구조

10. **전체 시스템 구조 명확화** (§1.2 ~ §1.7)
    - 기존 시스템: 인쇄 쇼핑몰 (PHP) - 유지
    - 신규 개발 (1): 편집기 (React) - 쇼핑몰에 임베딩
    - 신규 개발 (2): 편집기 관리자 (React) - 별도 관리자 URL
    - 신규 개발 (3): 워커 서비스 (서버) - API 기반
    - 시스템 간 연동 관계 다이어그램 추가
    - 개발 범위 명확화

---

**문서 작성**: Claude Code
**문서 버전**: 1.3
**최초 작성일**: 2025-12-03
**최종 업데이트**: 2025-12-03
- v1.0: 초안 작성 (PDF 분석 기반)
- v1.1: 회의록 반영 (셀프 편집 케이스, UI 연동, 토큰 관리 등)
- v1.2: 워커 아키텍처 변경 (클라이언트 설치형 → 서버 서비스)
- v1.3: 전체 시스템 구조 명확화 (기존 쇼핑몰 + 신규 3개 컴포넌트)
