<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bundle Load Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Editor Bundle Load Test</h1>
    <div id="logs"></div>
    <div id="editor-root" style="width: 100%; height: 400px; border: 1px solid #ccc; margin-top: 20px;"></div>

    <script>
        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = 'log ' + type;
            div.textContent = new Date().toLocaleTimeString() + ' - ' + msg;
            document.getElementById('logs').appendChild(div);
            console.log('[' + type + ']', msg);
        }
    </script>

    <!-- Load bundle -->
    <script>
        log('Starting bundle load...');
    </script>
    <script src="/assets/js/editor-bundle.iife.js" onload="onBundleLoad()" onerror="onBundleError(event)"></script>
    <script>
        function onBundleLoad() {
            log('Bundle script loaded successfully!', 'success');

            if (typeof window.StorigeEditor !== 'undefined') {
                log('StorigeEditor object exists', 'success');
                log('Version: ' + window.StorigeEditor.version, 'success');
                log('Has create function: ' + (typeof window.StorigeEditor.create === 'function'), 'success');

                // Try to create instance without mounting
                log('Creating editor instance (no mount)...');
                try {
                    const editor = window.StorigeEditor.create({
                        templateSetId: 'ts-test-001',
                        productId: 'PROD-001',
                        token: 'test-token',
                        apiBaseUrl: 'http://localhost:4000/api',
                        onReady: () => log('Editor ready callback', 'success'),
                        onError: (e) => log('Editor error: ' + e.message, 'error')
                    });
                    log('Editor instance created', 'success');

                    // Try mounting after 1 second
                    log('Will attempt mount in 1 second...');
                    setTimeout(() => {
                        log('Attempting mount...');
                        try {
                            editor.mount('editor-root');
                            log('Mount called', 'success');
                        } catch (e) {
                            log('Mount error: ' + e.message, 'error');
                        }
                    }, 1000);
                } catch (e) {
                    log('Create error: ' + e.message, 'error');
                }
            } else {
                log('StorigeEditor object NOT found!', 'error');
            }
        }

        function onBundleError(e) {
            log('Bundle load error: ' + e.message, 'error');
        }
    </script>
</body>
</html>
